{% extends "layout/base.html" %}
{% load i18n %}

{% block title %}{% trans "Set up two-factor authentication" %}{% endblock %}

{% block subnav %}
    {% with active='settings' %}
        {{ block.super }}
    {% endwith %}
{% endblock %}

{% block content %}

<nav class="inline-flex items-center space-x-2 text-gray-600 bg-white border rounded-md mb-6">
    <!-- Icon -->
    <a href="{% url 'authentication:user_settings' %}" class="flex items-center space-x-1 py-2 pl-2 group">
        <i class=" text-default group-hover:text-primary" data-feather="settings" width="14px" height="14px"></i>
        <span class="text-sm text-default group-hover:text-primary">{% trans "Settings" %}</span>
    </a>
    <!-- Separator -->
    <svg class="w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" d="M10.293 15.293a1 1 0 010-1.414L13.586 10 10.293 6.707a1 1 0 111.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
    </svg>
    <!-- Link -->
    <a href="#" class="text-default font-medium text-sm py-2 pr-2">{% trans "Two-factor authentication" %}</a>
</nav>

<div class="mb-6">
    <div class="flex items-center">
        <i class="text-2xl text-gray-700 mr-2" data-feather="lock"></i>
        <h1 class="text-2xl font-semibold text-default">{% trans "Set up two-factor authentication" %}</h1>
    </div>
</div>

<form method="post" action="{% url 'mfa_activate_totp' %}">
    {% csrf_token %}

    {% include 'components/forms/errors.html' %}

    <div class="my-6 bg-white shadow-sm border rounded-2xl">
        <div class="p-7">
            <img src="{{ totp_svg_data_uri }}" alt="Authenticator secret" class="w-64 h-64 mx-auto mb-4">
            <div class="text-center text-sm text-gray-600 mb-4">
                {% blocktrans %}To protect your account with two-factor authentication, scan the QR code above with your authenticator app. Then, input the verification code generated by the app below.{% endblocktrans %}
            </div>
            <div class="flex space-x-4">
                <div class="w-1/2 my-3">
                    <label for="authenticator_secret" class="block text-sm font-medium text-gray-700">
                        {% trans "Authenticator secret" %}
                    </label>
                    <input type="text" id="authenticator_secret" value="{{ form.secret }}" disabled class="mt-1 block w-full px-3 py-2 border bg-gray-50 border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">
                    <p class="mt-2 text-sm text-gray-500">
                        {% trans "You can store this secret and use it to reinstall your authenticator app at a later time." %}
                    </p>
                </div>
                <div class="w-1/2">
                    {{ form.code.as_field_group }}
                </div>
            </div>
        </div>
        <div class="flex items-center justify-between p-4 border-t">
            <button type="submit" class="bg-primary text-white px-4 py-2 rounded-2xl focus:outline-none">
                {% trans "Activate" %}
            </button>
        </div>
    </div>
</form>

{% endblock %}