{% extends "layout/base.html" %}
{% load i18n %}

{% block title %}{% trans "Form wizard" %}{% endblock %}

{% block subnav %}
    {% with active='example_form_wizard' %}
        {{ block.super }}
    {% endwith %}
{% endblock %}

{% block content %}

<div class="mb-6">
    <div class="flex items-center">
        <i class="text-2xl text-gray-700 mr-2" data-feather="layers"></i>
        <h1 class="text-2xl font-semibold text-default">{% trans "Form wizard" %}</h1>
    </div>
    <div>
    <p class="text-gray-500">
        {% trans "This example demonstrates how to integrate a multi-step form wizard using AlpineJS." %}
        <br/>{% trans "<b>Where can I find the template of this page?</b> You can find this template at" %} <code class="bg-gray-100 text-gray-700 p-1 rounded-2xl">shipwithdjango/examples/templates/examples/form_wizard.html</code>.
        <br/>{% trans "<b>Where can I find the backend logic of this page?</b> You can find the view" %} <code class="bg-gray-100 text-gray-700 p-1 rounded-2xl">FormWizardExample</code> {% trans "at" %} <code class="bg-gray-100 text-gray-700 p-1 rounded-2xl">shipwithdjango/examples/views.py</code>.
    </p>
    </div>
</div>

<div x-data="wizard()" x-cloak class="bg-white shadow-sm border rounded-2xl p-8">
    <div class="max-w-3xl mx-auto px-4 py-10">

        <div x-show.transition="step === 'complete'">
            <div class="p-10 flex items-center justify-between">
                <div>
                    <svg class="mb-4 h-20 w-20 text-green-500 mx-auto" viewBox="0 0 20 20" fill="currentColor">  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>

                    <h2 class="text-2xl mb-4 text-gray-800 text-center font-bold">Registration Success</h2>

                    <div class="text-gray-600 mb-8 text-center">
                        Thank you. We have sent you an email to demo@demo.test. Please click the link in the message to activate your account.
                    </div>

                    <button
                        @click="step = 1"
                        class="w-40 block mx-auto focus:outline-none py-2 px-5 rounded-lg shadow-sm text-center text-gray-600 bg-white hover:bg-gray-100 font-medium border" 
                    >Back to home</button>
                </div>
            </div>
        </div>

        <div x-show.transition="step != 'complete'">	
            <!-- Top Navigation -->
            <div class="border-b py-4">
                <div class="uppercase text-xs font-semibold text-gray-500 mb-1" x-text="`Step: ${step} of 3`"></div>
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="flex-1">
                        <div x-show="step === 1">
                            <div class="text-lg font-semibold">Your Profile</div>
                        </div>
                        
                        <div x-show="step === 2">
                            <div class="text-lg font-semibold">Your Password</div>
                        </div>

                        <div x-show="step === 3">
                            <div class="text-lg font-semibold">Tell me about yourself</div>
                        </div>
                    </div>

                    <div class="flex items-center md:w-64">
                        <div class="w-full bg-slate-100 rounded-full mr-2">
                            <div class="rounded-full bg-green-500 text-xs leading-none h-2 text-center text-white" :style="'width: '+ parseInt(step / 3 * 100) +'%'"></div>
                        </div>
                        <div class="text-xs w-10 text-gray-600" x-text="parseInt(step / 3 * 100) +'%'"></div>
                    </div>
                </div>
            </div>
            <!-- /Top Navigation -->

            <!-- Step Content -->
            <div class="py-10">	
                <div x-show.transition.in="step === 1">
                    <div class="mb-5">
                        <label for="firstname" class="text-sm font-medium text-gray-700 mb-2">Firstname</label>
                        <input type="text"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"
                            placeholder="Enter your firstname...">
                    </div>

                    <div class="mb-5">
                        <label for="email" class="text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"
                            placeholder="Enter your email address...">
                    </div>

                </div>
                <div x-show.transition.in="step === 2">

                    <div class="mb-5">
                        <label for="password" class="font-semibold mb-1">Set up password</label>
                        <div class="text-gray-600 mt-2 mb-4">
                            Please create a secure password including the following criteria below.

                            <ul class="list-disc text-sm ml-4 mt-2">
                                <li>lowercase letters</li>
                                <li>numbers</li>
                                <li>capital letters</li>
                                <li>special characters</li>
                            </ul>	
                        </div>

                        <div class="relative">
                            <input
                                :type="togglePassword ? 'text' : 'password'"
                                @keydown="checkPasswordStrength()"
                                x-model="password"
                                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"
                                placeholder="Your strong password...">

                            <div class="absolute right-0 bottom-0 top-0 px-3 py-3 cursor-pointer" 
                                @click="togglePassword = !togglePassword"
                            >	
                                <svg :class="{'hidden': !togglePassword, 'block': togglePassword }" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 fill-current text-gray-500" viewBox="0 0 24 24"><path d="M12 19c.946 0 1.81-.103 2.598-.281l-1.757-1.757C12.568 16.983 12.291 17 12 17c-5.351 0-7.424-3.846-7.926-5 .204-.47.674-1.381 1.508-2.297L4.184 8.305c-1.538 1.667-2.121 3.346-2.132 3.379-.069.205-.069.428 0 .633C2.073 12.383 4.367 19 12 19zM12 5c-1.837 0-3.346.396-4.604.981L3.707 2.293 2.293 3.707l18 18 1.414-1.414-3.319-3.319c2.614-1.951 3.547-4.615 3.561-4.657.069-.205.069-.428 0-.633C21.927 11.617 19.633 5 12 5zM16.972 15.558l-2.28-2.28C14.882 12.888 15 12.459 15 12c0-1.641-1.359-3-3-3-.459 0-.888.118-1.277.309L8.915 7.501C9.796 7.193 10.814 7 12 7c5.351 0 7.424 3.846 7.926 5C19.624 12.692 18.76 14.342 16.972 15.558z"/></svg>

                                <svg :class="{'hidden': togglePassword, 'block': !togglePassword }" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 fill-current text-gray-500" viewBox="0 0 24 24"><path d="M12,9c-1.642,0-3,1.359-3,3c0,1.642,1.358,3,3,3c1.641,0,3-1.358,3-3C15,10.359,13.641,9,12,9z"/><path d="M12,5c-7.633,0-9.927,6.617-9.948,6.684L1.946,12l0.105,0.316C2.073,12.383,4.367,19,12,19s9.927-6.617,9.948-6.684 L22.054,12l-0.105-0.316C21.927,11.617,19.633,5,12,5z M12,17c-5.351,0-7.424-3.846-7.926-5C4.578,10.842,6.652,7,12,7 c5.351,0,7.424,3.846,7.926,5C19.422,13.158,17.348,17,12,17z"/></svg>
                            </div>
                        </div>
                        
                        <div class="flex items-center mt-4 h-3">
                            <div class="w-2/3 flex justify-between h-2">	
                                <div :class="{ 'bg-red-400': passwordStrengthText == 'Too weak' ||  passwordStrengthText == 'Could be stronger' || passwordStrengthText == 'Strong password' }" class="h-2 rounded-full mr-1 w-1/3 bg-gray-300"></div>
                                <div :class="{ 'bg-orange-400': passwordStrengthText == 'Could be stronger' || passwordStrengthText == 'Strong password' }" class="h-2 rounded-full mr-1 w-1/3 bg-gray-300"></div>
                                <div :class="{ 'bg-green-400': passwordStrengthText == 'Strong password' }" class="h-2 rounded-full w-1/3 bg-gray-300"></div>
                            </div>
                            <div x-text="passwordStrengthText" class="text-gray-500 font-medium text-sm ml-3 leading-none"></div>
                        </div>
                    </div>

                </div>
                <div x-show.transition.in="step === 3">
                    <div class="mb-5">
                        <label for="email" class="text-sm font-medium text-gray-700 mb-2">Gender</label>
                        
                        <div class="flex">
                            <label
                                class="flex justify-start items-center text-truncate rounded-lg bg-slate-100 pl-4 pr-6 py-3 shadow-sm mr-4">
                                <div class="text-teal-600 mr-3">
                                    <input type="radio" x-model="gender" value="Male" class="form-radio focus:outline-none focus:shadow-outline" />
                                </div>
                                <div class="select-none text-gray-700">Male</div>
                            </label>

                            <label
                                class="flex justify-start items-center text-truncate rounded-lg bg-slate-100 pl-4 pr-6 py-3 shadow-sm">
                                <div class="text-teal-600 mr-3">
                                    <input type="radio" x-model="gender" value="Female" class="form-radio focus:outline-none focus:shadow-outline" />
                                </div>
                                <div class="select-none text-gray-700">Female</div>
                            </label>
                        </div>
                    </div>

                    <div class="mb-5">
                        <label for="profession" class="text-sm font-medium text-gray-700 mb-2">Profession</label>
                        <input type="profession"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"
                            placeholder="eg. Web Developer">
                    </div>
                </div>
            </div>
            <!-- / Step Content -->
        </div>
    </div>

    <!-- Bottom Navigation -->	
    <div x-show="step != 'complete'">
        <div class="max-w-3xl mx-auto px-4">
            <div class="flex justify-between">
                <div class="w-1/2">
                    <button
                        x-show="step > 1"
                        @click="step--"
                        class="w-32 focus:outline-none py-2 px-5 rounded-lg shadow-sm text-center text-gray-600 bg-white hover:bg-gray-100 font-medium border" 
                    >Previous</button>
                </div>

                <div class="w-1/2 text-right">
                    <button
                        x-show="step < 3"
                        @click="step++"
                        class="w-32 focus:outline-none border border-transparent py-2 px-5 rounded-lg shadow-sm text-center text-white bg-blue-500 hover:bg-blue-600 font-medium" 
                    >Next</button>

                    <button
                        @click="step = 'complete'"
                        x-show="step === 3"
                        class="w-32 focus:outline-none border border-transparent py-2 px-5 rounded-lg shadow-sm text-center text-white bg-blue-500 hover:bg-blue-600 font-medium" 
                    >Complete</button>
                </div>
            </div>
        </div>
    </div>
</div>


{% endblock %}
{% block scripting %}
<script>
    function wizard() {
        return {
            step: 1, 
            passwordStrengthText: '',
            togglePassword: false,
            password: '',
            gender: 'Male',

            checkPasswordStrength() {
                var strongRegex = new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})");
                var mediumRegex = new RegExp("^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})");

                let value = this.password;

                if (strongRegex.test(value)) {
                    this.passwordStrengthText = "Strong password";
                } else if(mediumRegex.test(value)) {
                    this.passwordStrengthText = "Could be stronger";
                } else {
                    this.passwordStrengthText = "Too weak";
                }
            }
        }
    }
</script>
{% endblock %}